geom_line()  +
geom_point(aes(color = factor(weekends))) +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]",
color = "Weekend"
) +
scale_color_manual(values = c(color_vector[1], color_vector[7])) +
#scale_y_continuous(trans = "log", breaks = c(10, 100, 1000, 10000, 100000)) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30, ], aes(x = distances/1000, y = average_speed*3.6, color = factor(weekends))) +
geom_line()  +
geom_point(aes(color = factor(weekends))) +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]",
color = "Weekend"
) +
scale_color_manual(values = c(color_vector[1], color_vector[7])) +
#scale_y_continuous(trans = "log", breaks = c(10, 100, 1000, 10000, 100000)) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30, ], aes(x = distances/1000, y = average_speed*3.6, color = factor(weekends))) +
geom_density_2d() +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]",
color = "Weekend"
) +
scale_color_manual(values = c(color_vector[1], color_vector[7])) +
#scale_y_continuous(trans = "log", breaks = c(10, 100, 1000, 10000, 100000)) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d() +
theme_bw() +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]",
color = "Weekend"
)
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 70) +
scale_fill_continuous(type = "viridis") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]",
color = "Weekend"
)
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 && skimmed_df$average_speed*>0, ], aes(x = distances/1000, y = average_speed*3.6)) +
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 && skimmed_df$average_speed>0, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 70) +
scale_fill_continuous(type = "viridis") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]",
color = "Weekend"
)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 70) +
scale_fill_continuous(type = "viridis") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]",
color = "Weekend"
)
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 70) +
scale_fill_continuous(type = "viridis") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]",
color = "Weekend"
) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 70) +
scale_fill_continuous(type = "viridis") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 70) +
scale_fill_continuous(type = "viridis") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100) +
scale_fill_continuous(type = "viridis") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100) +
scale_fill_continuous(type = "inferno") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
theme(plot.title = element_text(hjust = 0.5))
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100) +
scale_fill_continuous(type = "gradient") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100) +
scale_fill_continuous(type = "viridis") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100) +
scale_fill_continuous(type = "viridis") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(aes(bins = 100, y=after_stat(density)) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, y=after_stat(density)) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, after_stat(density)) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends) +
theme(plot.title = element_text(hjust = 0.5))
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(aes(x = 100, after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(aes(x = 100, y=after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = ..density..) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = ..density..)) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends,
labeller = labeller(
weekends = function(type){
if (type==TRUE)
return ('Weekends')
else
return ('Weekdays')
})) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends,
labeller = labeller(
weekends = function(type){
if (type==TRUE){
return ('Weekends')
}
return ('Weekdays')
})) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends,
labeller = labeller(
lapply(weekends, function(type){
if (type==TRUE){
return ('Weekends')
}
return ('Weekdays')
}))) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends,
labeller =
lapply(weekends, function(type){
if (type==TRUE){
return ('Weekends')
}
return ('Weekdays')
})) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends,
labeller = function(type){
if (type==TRUE){
return ('Weekends')
}
return ('Weekdays')
}) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(weekends ~ .,
labeller = function(type){
if (type==TRUE){
return ('Weekends')
}
return ('Weekdays')
}) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(weekends ~ .,
) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(weekends ~ .,
labeller = function(variable,type){
if (type==TRUE){
return ('Weekends')
}
return ('Weekdays')
}) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(. ~ weekends,
labeller = function(variable,type){
if (type==TRUE){
return ('Weekends')
}
return ('Weekdays')
}) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends,
labeller = labeller(
weekends = function(variable) {
if (variable == TRUE) {
return('Weekends')
} else {
return('Weekdays')
}
}
)) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends,
labeller = labeller(
weekends = function(variable) {
print(weekends)
if (variable == TRUE) {
return('Weekends')
} else {
return('Weekdays')
}
}
)) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
facet_labels <- c(
"TRUE"  = "Weekends",
"FALSE" = "Weekdays"
)
p <- ggplot(skimmed_df[skimmed_df$average_speed*3.6<30 & skimmed_df$average_speed>0 & skimmed_df$distances < 7.5e03, ], aes(x = distances/1000, y = average_speed*3.6)) +
geom_bin2d(bins = 100, aes(fill = after_stat(density))) +
scale_fill_continuous(type = "viridis", name="Density") +
labs(
title = "Average Speed vs route length",
x = "Length [km]",
y = "Average Speed [km/h]"
) +
facet_wrap(~ weekends, labeller = as_labeller(facet_labels)) +
theme(plot.title = element_text(hjust = 0.5))
print(p)
start_station_count <- skimmed_df %>%
group_by(start.station.id) %>%
summarise(start_count = n())
end_station_count   <- skimmed_df %>%
group_by(end.station.id) %>%
summarise(end_count = n())
route_count         <- skimmed_df %>%
group_by(start.station.id, end.station.id) %>%
summarise(route_count = n())
start_station_count <- skimmed_df %>%
group_by(start.station.id) %>%
summarise(start_count = n())
end_station_count   <- skimmed_df %>%
group_by(end.station.id) %>%
summarise(end_count = n())
route_count         <- skimmed_df %>%
group_by(start.station.id, end.station.id) %>%
summarise(route_count = n()) %>%
order_by(route_count, "ASC")
start_station_count <- skimmed_df %>%
group_by(start.station.id) %>%
summarise(start_count = n())
end_station_count   <- skimmed_df %>%
group_by(end.station.id) %>%
summarise(end_count = n())
route_count         <- skimmed_df %>%
group_by(start.station.id, end.station.id) %>%
summarise(route_count = n()) %>%
arrange(route_count, .desc = FALSE)
View(route_count)
start_station_count <- skimmed_df %>%
group_by(start.station.id) %>%
summarise(start_count = n()) %>%
arrange(start_count, .desc = FALSE)
end_station_count   <- skimmed_df %>%
group_by(end.station.id) %>%
summarise(end_count = n()) %>%
arrange(end_count, .desc = FALSE)
route_count         <- skimmed_df %>%
group_by(start.station.id, end.station.id) %>%
summarise(route_count = n()) %>%
arrange(route_count, .desc = FALSE)
start_station_count[1,]
start_station_count[2,]
start_station_count[1,]
start_station_count[1,1]
start_station_count[[1,1]]
sprintf("The most common start station has ID: %i", start_station_count[[1,1]])
