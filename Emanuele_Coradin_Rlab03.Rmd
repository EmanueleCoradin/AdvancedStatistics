---
title: "Assignment 3"
author: "Emanuele Coradin"
date: "2024-04-30"
output: 
  read_document: rmdformats::readthedown
  html_document:
    number_sections: true
    theme: spacelab
  pdf_document:
    number_sections: true
    toc: true
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

color_vector <- c("#CC0000",   # Dark red
                  "#CC79A7",   # Muted purple
                  "#D55E00",   # Vermilion
                  "#009E73",   # Bluish green
                  "#56B4E9",   # Sky blue
                  '#000046',   # Deep Blue
                  "#DB1E60",   # Pinkish-red
                  "#E69F00")   # Yellow-orange

```
```{r, message=FALSE, echo=FALSE}
library(dplyr)
library(ggplot2)
```
#Assignment 3

# Exercise 1: Bayesian Inference for Poisson model 

The number of particles emitted by a radioactive source during a fixed interval of time $(\Delta t = 10 s)$ follows a Poisson distribution on the parameter $\mu$. The number of particles observed during consecutive time intervals is: 4, 1, 3, 1, 5 and 3. 

  1.1. Assuming a positive uniform prior distribution for the parameter $\mu$ 
  
    * determine and draw the posterior distribution for $\mu$, given the data 
    
    * evaluate mean, median and variance, both analytically and numerically in R;
  
  1.2. assuming a Gamma prior such that the expected value is $\mu = 3$ with a standard deviation $\sigma = 1$, 
  
    * determine and draw the posterior distribution for µ, given the data;
    
    * evaluate mean, median and variance, both analytically and numerically in R. 
  
  1.3. evaluate a $95\%$ credibility interval for the results obtained with different priors. Compare the result with that obtained using a normal approximation for the posterior distribution, with the same mean and standard deviation.

```{r 1.}
observed_particles <- c(4, 1, 3, 1, 5, 3)

```

# Exercise 2: Efficiency using Bayesian approach 

A researcher A wants to evaluate the efficiency of detector 2 (Det2). For this purpose, he sets up the apparatus shown in the figure 1, where Det2 is sandwiched between Det1 and Det3. Let n be the number of signals recorded simultaneously by Det1 and Det3, and r be those also recorded by Det2, researcher A obtains n = 500 and r = 312.
Assuming a binomial model where n is the number of trials and r is the number of success out of n trials, 

  2.1. Evaluate the mean and the variance using a Bayesian approach under the hypothesis of:
    
    * uniform prior ∼ U(0, 1) 
    
    * Jeffrey’s prior ∼ Beta(1/2, 1/2) 
  
  2.2. Plot the posterior distributions for both cases Taking into account that the same detector has been studied by researcher B, who has performed only n = 10 measurements and has obtained r = 10 signals, 
  
  2.3. Evaluate the mean, the variance and the posterior distribution using a uniform prior with the results of researcher B. 
  
  2.4. Repeat the computation of points 2.1 and 2.2 with the data of researcher A using as a prior the posterior obtained from point 2.3. 
  
  2.5 [Optional] Compute $95\%$ credible interval using the posterior of the previous point 2.4.

```{r }
```

# Exercise 3 - Bayesian Inference for Binomial model 

A coin is flipped n = 30 times with the following outcomes: T, T, T, T, T, H, T, T, H, H, T, T, H, H, H, T, H, T, H, T, H, H, T, H, T, H, T, H, H, H 

  3.1. Assuming a flat prior, and a beta prior, plot the likelihood, prior and posterior distributions for the data set.
  
  3.2. Evaluate the most probable value for the coin probability p and, integrating the posterior probability distribution, give an estimate for a $95\%$ credibility interval. 
  
  3.3. Repeat the same analysis assuming a sequential analysis of the data. Show how the most probable value and the credibility interval change as a function of the number of coin tosses (i.e. from 1 to 30). 
  
  3.4. Do you get a different result, by analyzing the data sequentially with respect to a one-step analysis (i.e. considering all the data as a whole) ? 

```{r }
```

# Exercise 4 - Poll 

A couple of days before an election in which four parties (A,B,C,D) compete, a poll is taken using a sample of 200 voters who express the following preferences 57, 31,45 and 67 for, respectively, parties A,B,C and D. Using a Bayesian approach, for all parties 

  4.1. Calculate the expected percentage of votes and a 68% credibility interval by assuming as prior a – uniform prior – a prior constructed from the results obtained from another poll conducted the previous week on a sample of 100 voters who expressed the following preferences 32,14,26,28 for, respectively, parties A,B,C and D. 
  
  4.2. Sample size to obtain a margin of error less or equal than $\pm 3\%$ for each party

```{r }
```


